--- src/fpu.cpp	2008-05-10 08:25:19.000000000 +0900
+++ src/fpu.cpp	2012-06-08 14:50:46.276453256 +0900
@@ -14,6 +14,15 @@
 #include "config.h"
 #include <qd/fpu.h>
 
+#ifdef  __cplusplus
+extern "C" {
+#endif
+unsigned int _controlfp (unsigned int unNew, unsigned int unMask);
+unsigned int _control87 (unsigned int unNew, unsigned int unMask);
+#ifdef  __cplusplus
+}
+#endif
+
 #ifdef X86
 #ifdef  _WIN32
 #include <float.h>
--- src/Makefile.am~	2018-10-31 01:05:02.000000000 +0900
+++ src/Makefile.am	2022-06-13 07:13:44.723426290 +0900
@@ -1,6 +1,8 @@
 SRC = c_dd.cpp c_qd.cpp dd_real.cpp dd_const.cpp \
       fpu.cpp qd_real.cpp qd_const.cpp util.cpp bits.cpp util.h
 
+AM_LDFLAGS = -no-undefined
+
 lib_LTLIBRARIES = libqd.la
 
 libqd_la_SOURCES = $(SRC)

--- configure.ac~	2018-10-31 01:01:31.000000000 +0900
+++ configure.ac	2022-06-13 15:54:58.800021111 +0900
@@ -23,6 +23,8 @@
 
 AC_CANONICAL_HOST
 
+AC_LIBTOOL_WIN32_DLL
+
 # Checks for arguments
 # --enable-inline
 AC_ARG_ENABLE(enable_inline, AC_HELP_STRING(--enable-inline, [inline commonly used functions.  [[default=yes]]]))
